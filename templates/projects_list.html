{% extends "base.html" %}
{% block title %}Listă Proiecte{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Listă Proiecte</h2>
    {% if current_user.role == 'admin' %}
      <a href="{{ url_for('create_project') }}" class="btn btn-success">Creează Proiect Nou</a>
    {% endif %}
  </div>

  {% if projects %}
    <ul class="list-group">
      {% for project in projects %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <h5>
              <a href="{{ url_for('view_project', project_id=project.id) }}">{{ project.name }}</a>
            </h5>
            <p>{{ project.description|truncate(150) if project.description else 'Fără descriere' }}</p>
            <small>Creat de: {{ project.creator.username }} la {{ project.creation_date.strftime('%d-%m-%Y %H:%M') }}</small>
          </div>
          {% if current_user.role == 'admin' %}
          <div>
            <a href="{{ url_for('edit_project', project_id=project.id) }}" class="btn btn-warning btn-sm mr-2">Editează</a>
            <form method="POST" action="{{ url_for('delete_project', project_id=project.id) }}" style="display: inline;" onsubmit="return confirm('Ești sigur că vrei să ștergi acest proiect și toate fișierele sale? Această acțiune este ireversibilă!');">
                <button type="submit" class="btn btn-danger btn-sm">Șterge Proiect</button>
            </form>
          </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Nu există proiecte de afișat.</p>
    {% if current_user.role == 'admin' %}
      <p>Poți crea primul proiect folosind butonul de mai sus.</p>
    {% endif %}
  {% endif %}
{% endblock %}